{"filter":false,"title":"eatz.js","tooltip":"/routes/eatz.js","undoManager":{"mark":24,"position":24,"stack":[[{"group":"doc","deltas":[{"start":{"row":43,"column":0},"end":{"row":48,"column":0},"action":"insert","lines":["","// Models","var User = mongoose.model('User', UserSchema);","var Dish = mongoose.model('Dish', DishSchema);","",""]},{"start":{"row":51,"column":0},"end":{"row":55,"column":0},"action":"remove","lines":["// Models","var User = mongoose.model('User', UserSchema);","var Dish = mongoose.model('Dish', DishSchema);","",""]},{"start":{"row":61,"column":0},"end":{"row":87,"column":45},"action":"remove","lines":["\t// First find that req dish","  Dish.findOne({'_id':req.params.id}, function(err, dish) {","        if (err) {","            res.send(500, \"Sorry, unable to retrieve dish at this time (\" ","                +err.message+ \")\" );","        } else if (!dish) {","            res.send(404, \"Sorry, that dish doesn't exist; try reselecting from browse view\");","        } else {","    //       //console.log(dish);","    //       dish.venue = req.body.venue;","    //       // using update command to update the dish information, then send back the the response","    //         Dish.update({'_id':dish._id}, ","\t\t\t\t// {$set: {'name':req.body.name, 'venue':req.body.venue, 'info':req.body.info","\t\t\t\t// , 'numbr':req.body.numbr, 'street':req.body.street, 'city':req.body.city","\t\t\t\t// , 'province':req.body.province, 'url':req.body.url, 'lat':req.body.lat, 'lng':req.body.lng}});","    //         Dish.find({}, function(error, result){console.log(\"After update \" + result)});","    //         //console.log(dish);","            Dish.findOne({'name':req.body.name, 'venue': req.body.venue}, function(dishErr, dupDish){","              if (dishErr) {","                  res.send(500, \"Sorry, unable to retrieve dish at this time (\" ","                      +err.message+ \")\" );","              } ","              else if (!dupDish) {","                console.log(dupDish);","                  Dish.remove({'_id':dish.id}, function(error, removeResult){","                    if (!error){","                      var newDish = new Dish("]},{"start":{"row":61,"column":0},"end":{"row":64,"column":12},"action":"insert","lines":["  var dish = new Dish(req.body);","  delete req.body._id;","  Dish.findByIdAndUpdate({\"_id\": req.params.id}, ","    {$set : "]},{"start":{"row":64,"column":20},"end":{"row":64,"column":22},"action":"remove","lines":[");"]},{"start":{"row":64,"column":20},"end":{"row":64,"column":23},"action":"insert","lines":["}, "]},{"start":{"row":65,"column":4},"end":{"row":65,"column":35},"action":"remove","lines":["                  newDish.save("]},{"start":{"row":65,"column":12},"end":{"row":65,"column":17},"action":"remove","lines":[" (new"]},{"start":{"row":65,"column":12},"end":{"row":65,"column":13},"action":"insert","lines":["("]},{"start":{"row":65,"column":25},"end":{"row":65,"column":26},"action":"remove","lines":[" "]},{"start":{"row":66,"column":0},"end":{"row":66,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":66,"column":9},"end":{"row":66,"column":12},"action":"remove","lines":["new"]},{"start":{"row":66,"column":13},"end":{"row":67,"column":20},"action":"remove","lines":[" {  // save successful, result contains saved dish model","                    "]},{"start":{"row":66,"column":13},"end":{"row":67,"column":0},"action":"insert","lines":["{",""]},{"start":{"row":68,"column":0},"end":{"row":68,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":69,"column":0},"end":{"row":69,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":70,"column":0},"end":{"row":70,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":71,"column":0},"end":{"row":71,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":72,"column":0},"end":{"row":72,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":73,"column":0},"end":{"row":73,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":74,"column":0},"end":{"row":74,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":75,"column":0},"end":{"row":75,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":76,"column":0},"end":{"row":76,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":77,"column":0},"end":{"row":77,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":78,"column":0},"end":{"row":78,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":79,"column":0},"end":{"row":79,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":80,"column":0},"end":{"row":80,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":80,"column":71},"end":{"row":81,"column":8},"action":"insert","lines":["","        "]},{"start":{"row":81,"column":9},"end":{"row":81,"column":10},"action":"remove","lines":[" "]},{"start":{"row":81,"column":47},"end":{"row":84,"column":20},"action":"remove","lines":["","                        }","                        else {  // save failed","                    "]},{"start":{"row":81,"column":47},"end":{"row":84,"column":0},"action":"insert","lines":["      ","    }","    else{",""]},{"start":{"row":84,"column":10},"end":{"row":84,"column":13},"action":"remove","lines":["new"]},{"start":{"row":84,"column":17},"end":{"row":84,"column":20},"action":"insert","lines":["msg"]},{"start":{"row":85,"column":0},"end":{"row":85,"column":20},"action":"remove","lines":["                    "]},{"start":{"row":85,"column":39},"end":{"row":85,"column":43},"action":"remove","lines":["newD"]},{"start":{"row":85,"column":39},"end":{"row":85,"column":40},"action":"insert","lines":["d"]},{"start":{"row":85,"column":56},"end":{"row":85,"column":60},"action":"remove","lines":["newD"]},{"start":{"row":85,"column":56},"end":{"row":85,"column":57},"action":"insert","lines":["d"]},{"start":{"row":86,"column":6},"end":{"row":88,"column":20},"action":"remove","lines":["                    }","                          else","                    "]},{"start":{"row":86,"column":6},"end":{"row":88,"column":0},"action":"insert","lines":["}","      else{",""]},{"start":{"row":89,"column":6},"end":{"row":90,"column":13},"action":"remove","lines":["                    + newerr.message);","             "]},{"start":{"row":89,"column":6},"end":{"row":89,"column":21},"action":"insert","lines":["+ err.message);"]},{"start":{"row":89,"column":29},"end":{"row":89,"column":35},"action":"remove","lines":["     }"]},{"start":{"row":90,"column":6},"end":{"row":90,"column":28},"action":"remove","lines":["                });   "]},{"start":{"row":90,"column":6},"end":{"row":90,"column":7},"action":"insert","lines":["}"]},{"start":{"row":90,"column":13},"end":{"row":90,"column":16},"action":"remove","lines":["   "]},{"start":{"row":91,"column":4},"end":{"row":101,"column":2},"action":"remove","lines":["                  res.send(200, newDish);","                    } ","                    else{","                      res.send(500, \"Cannot delete Dish\");","                    }","                  });","              }","            });","\t     }","\t","  "]},{"start":{"row":91,"column":4},"end":{"row":92,"column":0},"action":"insert","lines":["}",""]},{"start":{"row":100,"column":0},"end":{"row":101,"column":0},"action":"insert","lines":["    console.log(err);",""]},{"start":{"row":115,"column":67},"end":{"row":116,"column":8},"action":"insert","lines":["","        "]},{"start":{"row":116,"column":9},"end":{"row":116,"column":10},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":28},"end":{"row":256,"column":29},"action":"remove","lines":["\""]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":27},"end":{"row":256,"column":28},"action":"remove","lines":["\""]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":27},"end":{"row":256,"column":28},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":28},"end":{"row":256,"column":29},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":29},"end":{"row":256,"column":30},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":30},"end":{"row":256,"column":31},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":31},"end":{"row":256,"column":32},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":32},"end":{"row":256,"column":33},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":32},"end":{"row":256,"column":33},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":27},"end":{"row":256,"column":32},"action":"remove","lines":["undef"]},{"start":{"row":256,"column":27},"end":{"row":256,"column":36},"action":"insert","lines":["undefined"]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":48},"end":{"row":256,"column":49},"action":"remove","lines":["\""]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":47},"end":{"row":256,"column":48},"action":"remove","lines":["\""]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":47},"end":{"row":256,"column":48},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":48},"end":{"row":256,"column":49},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":49},"end":{"row":256,"column":50},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":256,"column":47},"end":{"row":256,"column":50},"action":"remove","lines":["und"]},{"start":{"row":256,"column":47},"end":{"row":256,"column":56},"action":"insert","lines":["undefined"]}]}],[{"group":"doc","deltas":[{"start":{"row":255,"column":0},"end":{"row":255,"column":32},"action":"remove","lines":["      req.session.userid = null;"]}]}],[{"group":"doc","deltas":[{"start":{"row":254,"column":34},"end":{"row":255,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":254,"column":29},"end":{"row":254,"column":33},"action":"remove","lines":["null"]},{"start":{"row":254,"column":29},"end":{"row":254,"column":30},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":254,"column":30},"end":{"row":254,"column":31},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":254,"column":31},"end":{"row":254,"column":32},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":254,"column":32},"end":{"row":254,"column":33},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":254,"column":33},"end":{"row":254,"column":34},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":254,"column":29},"end":{"row":254,"column":34},"action":"remove","lines":["undef"]},{"start":{"row":254,"column":29},"end":{"row":254,"column":38},"action":"insert","lines":["undefined"]}]}]]},"ace":{"folds":[],"scrolltop":2950,"scrollleft":0,"selection":{"start":{"row":261,"column":53},"end":{"row":261,"column":53},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":209,"state":"no_regex","mode":"ace/mode/javascript"}},"timestamp":1418917706622,"hash":"3350dec3d093aa55fb0bfe75fc552a6d03d9f784"}